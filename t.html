<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Terminal Chida</title>
<link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet">
<style>
    body { margin:0; height:100vh; background:#0d0d0d; color:#00ff00; font-family:'Fira Code', monospace; display:flex; flex-direction:column; }
    #terminal { flex:1; padding:20px; overflow-y:auto; white-space:pre-wrap; }
    #inputArea { display:flex; padding:10px; background:#111; border-top:2px solid #00ff00; }
    #cmdInput { flex:1; background:transparent; border:none; color:#00ff00; font-family:'Fira Code', monospace; font-size:16px; outline:none; }
    #executeBtn { padding:0 15px; background:#00ff00; color:#000; border:none; cursor:pointer; font-weight:bold; font-family:'Fira Code', monospace; }
</style>
</head>
<body>

<div id="terminal">💻 Bienvenido a tu Terminal Chida!\n</div>

<div id="inputArea">
    <input type="text" id="cmdInput" placeholder="Escribe un comando..." autofocus />
    <button id="executeBtn">Ejecutar</button>
</div>

<script>
const terminal = document.getElementById('terminal');
const cmdInput = document.getElementById('cmdInput');
const executeBtn = document.getElementById('executeBtn');

function printToTerminal(text) {
    terminal.textContent += text + '\n';
    terminal.scrollTop = terminal.scrollHeight;
}

async function executeCommand(cmd) {
    printToTerminal(`> ${cmd}`);

    try {
        // Detecta comando git clone especial
        if(cmd.startsWith('git clone')) {
            const parts = cmd.split(' ');
            const url = parts[2];
            const tokenPrompt = prompt('Si es repositorio privado, ingresa tu token, si no deja vacío:');
            
            const response = await fetch('http://localhost:3000/gitclone', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ url, token: tokenPrompt })
            });
            const data = await response.text();
            printToTerminal(data);
        } else {
            const response = await fetch('http://localhost:3000/execute', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ command: cmd })
            });
            const data = await response.text();
            printToTerminal(data);
        }
    } catch (err) {
        printToTerminal(`❌ Error: ${err}`);
    }
}

executeBtn.addEventListener('click', () => {
    const cmd = cmdInput.value.trim();
    if(cmd) {
        executeCommand(cmd);
        cmdInput.value = '';
    }
});

cmdInput.addEventListener('keydown', (e) => {
    if(e.key === 'Enter') executeBtn.click();
});
</script>

</body>
</html>
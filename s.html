<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>To URL Imagen ‚Äî Herramienta</title>
  <style>
    body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial; background:#f5f7fb; color:#111; padding:24px;}
    .card{background:#fff;border-radius:12px;padding:18px;box-shadow:0 6px 18px rgba(20,30,60,0.08);max-width:900px;margin:12px auto;}
    h1{margin:0 0 12px;font-size:20px}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .col{flex:1;min-width:260px}
    input[type="text"], textarea{width:100%;padding:8px;border-radius:8px;border:1px solid #e0e6f0}
    button{padding:8px 12px;border-radius:8px;border:0;background:#4f46e5;color:#fff;cursor:pointer}
    img.preview{max-width:100%;border-radius:8px;display:block;margin-top:8px}
    pre{background:#0b1220;color:#dbeafe;padding:8px;border-radius:8px;overflow:auto;max-height:240px}
    .small{font-size:13px;color:#556}
    .actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
  </style>
</head>
<body>
  <div class="card">
    <h1>ToURL Imagen ‚Äî convertidor / visor</h1>
    <p class="small">Sube una imagen o pega una URL. Obt√©n la Data URL (base64) para incrustar en HTML/CSS o copia la URL directa.</p>

    <div class="row" style="margin-top:12px">
      <!-- Subir desde PC -->
      <div class="col">
        <h3>1) Subir imagen (desde tu PC)</h3>
        <input id="fileInput" type="file" accept="image/*" />
        <div id="previewBox"></div>
        <div class="actions">
          <button id="copyDataUrlBtn">Copiar Data URL</button>
          <button id="downloadDataBtn">Descargar (archivo)</button>
        </div>
        <p class="small" style="margin-top:8px">La <strong>Data URL</strong> es la imagen codificada en base64 (√∫til para &lt;img src="data:..."/&gt; o CSS).</p>
      </div>

      <!-- Pegar URL -->
      <div class="col">
        <h3>2) Pegar URL de imagen</h3>
        <input id="urlInput" type="text" placeholder="https://ejemplo.com/miimagen.png" />
        <div style="margin-top:8px" class="actions">
          <button id="loadUrlBtn">Cargar URL</button>
          <button id="copyImgUrlBtn">Copiar URL visible</button>
        </div>
        <div id="urlPreviewBox"></div>
        <p class="small" style="margin-top:8px">Si la URL es v√°lida ver√°s la imagen y un enlace para descargarla.</p>
      </div>
    </div>

    <hr style="margin:16px 0;border:none;border-top:1px solid #eef2ff" />

    <h3>Salida / Data URL</h3>
    <textarea id="dataUrlOutput" rows="6" placeholder="Aqu√≠ aparecer√° la Data URL cuando subas una imagen"></textarea>
    <div style="margin-top:8px" class="actions">
      <button id="copyOutputBtn">Copiar salida</button>
      <button id="clearBtn" style="background:#ef4444">Limpiar</button>
    </div>
  </div>

  <script>
    const fileInput = document.getElementById('fileInput');
    const previewBox = document.getElementById('previewBox');
    const dataUrlOutput = document.getElementById('dataUrlOutput');
    const copyDataUrlBtn = document.getElementById('copyDataUrlBtn');
    const downloadDataBtn = document.getElementById('downloadDataBtn');

    const urlInput = document.getElementById('urlInput');
    const loadUrlBtn = document.getElementById('loadUrlBtn');
    const urlPreviewBox = document.getElementById('urlPreviewBox');
    const copyImgUrlBtn = document.getElementById('copyImgUrlBtn');

    const copyOutputBtn = document.getElementById('copyOutputBtn');
    const clearBtn = document.getElementById('clearBtn');

    function setPreview(imgEl, container) {
      container.innerHTML = '';
      container.appendChild(imgEl);
    }

    // Cuando el usuario sube un archivo: generar dataURL
    fileInput.addEventListener('change', async (e) => {
      const file = e.target.files?.[0];
      if (!file) return;
      if (!file.type.startsWith('image/')) {
        alert('Selecciona un archivo de imagen.');
        return;
      }

      const reader = new FileReader();
      reader.onload = () => {
        const dataUrl = reader.result;
        dataUrlOutput.value = dataUrl;
        const img = document.createElement('img');
        img.className = 'preview';
        img.src = dataUrl;
        setPreview(img, previewBox);
      };
      reader.readAsDataURL(file);
    });

    // Copiar data url al portapapeles
    copyDataUrlBtn.addEventListener('click', async () => {
      const text = dataUrlOutput.value.trim();
      if (!text) return alert('No hay Data URL para copiar.');
      await navigator.clipboard.writeText(text);
      alert('Data URL copiada al portapapeles ‚úÖ');
    });

    // Descargar la imagen desde la data url (convierte a blob)
    downloadDataBtn.addEventListener('click', async () => {
      const dataUrl = dataUrlOutput.value.trim();
      if (!dataUrl) return alert('No hay imagen para descargar.');
      // convertir dataURL a blob
      const res = await fetch(dataUrl);
      const blob = await res.blob();
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'imagen';
      document.body.appendChild(a);
      a.click();
      a.remove();
    });

    // Cargar desde URL externa
    loadUrlBtn.addEventListener('click', () => {
      const url = urlInput.value.trim();
      if (!url) return alert('Pega una URL primero.');
      // mostrar imagen y enlace de descarga
      const img = document.createElement('img');
      img.className = 'preview';
      img.src = url;
      img.onerror = () => {
        urlPreviewBox.innerHTML = '<p class="small" style="color:#b91c1c">No se pudo cargar la imagen (CORS o URL inv√°lida).</p>';
      };
      img.onload = () => {
        urlPreviewBox.innerHTML = '';
        setPreview(img, urlPreviewBox);

        // a√±adir enlace de descarga directa (puede fallar por CORS si el servidor lo bloquea)
        const a = document.createElement('a');
        a.href = url;
        a.textContent = 'üîó Abrir / Descargar imagen';
        a.target = '_blank';
        a.style.display = 'inline-block';
        a.style.marginTop = '8px';
        urlPreviewBox.appendChild(a);
      };
    });

    copyImgUrlBtn.addEventListener('click', async () => {
      const url = urlInput.value.trim();
      if (!url) return alert('No hay URL para copiar.');
      await navigator.clipboard.writeText(url);
      alert('URL copiada al portapapeles ‚úÖ');
    });

    copyOutputBtn.addEventListener('click', async () => {
      const out = dataUrlOutput.value.trim();
      if (!out) return alert('No hay texto en la salida.');
      await navigator.clipboard.writeText(out);
      alert('Salida copiada ‚úÖ');
    });

    clearBtn.addEventListener('click', () => {
      dataUrlOutput.value = '';
      previewBox.innerHTML = '';
      urlPreviewBox.innerHTML = '';
      urlInput.value = '';
      fileInput.value = '';
    });

    // Opcional: permitir pegar imagen directamente desde el portapapeles (Ctrl+V) cuando el textarea est√© activo
    dataUrlOutput.addEventListener('paste', (e) => {
      // esto solo detecta texto pegado; para im√°genes hay que manejar el evento de paste en general
    });
  </script>
</body>
</html>